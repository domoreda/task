webpackJsonp([4],{"JIR/":function(t,e,i){var o=i("MFWs");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i("rjj0")("3c589f7c",o,!0)},MFWs:function(t,e,i){e=t.exports=i("FZ+f")(!1),e.push([t.i,".el-tooltip__popper{max-width:40vw!important}",""])},MhFO:function(t,e,i){"use strict";var o=i("Dd8w"),r=i.n(o),a=i("NYxO"),n=i("0xDb"),l={id:0,productName:""},c={page:0,size:999,projection:"bigProduct",productName:""};e.a={data:function(){return{loading:!1,dialogFormVisible:!1,dialogStatus:"",searchForm:i.i(n.e)(c),textMap:{update:"编辑",create:"创建"},formData:i.i(n.e)(l),bigProduct:{}}},computed:r()({},i.i(a.b)(["menus","products","bigProducts","selectedBigProduct","selectedProduct","productDetails"])),mounted:function(){this.selectedBigProduct&&this.selectedBigProduct.id&&(this.bigProduct=this.selectedBigProduct)},watch:{menus:function(){var t=this.$route.query.id,e=this.menus.filter(function(e){return e.id===parseInt(t)});e.length&&(this.bigProduct=e[0])}},methods:r()({},i.i(a.c)(["createProduct","updateProduct","deleteProduct","queryAllProducts","queryAllDetails"]),{query:function(){var t=this;this.loading=!0,this.queryAllProducts(this.searchForm).then(function(){t.loading=!1}).catch(function(e){console.log(e),t.loading=!1})},handleCreate:function(){this.formData=i.i(n.e)(l),this.dialogStatus="create",this.dialogFormVisible=!0},create:function(){var t=this;this.$refs.productForm.validate(function(e){if(e){t.loading=!0;var o={pid:t.selectedBigProduct.id,product:t.formData,bigProduct:t.bigProducts};t.createProduct(o).then(function(e){i.i(n.d)(),t.dialogFormVisible=!1,t.loading=!1,t.query()}).catch(function(e){i.i(n.d)("",{type:"error"}),t.loading=!1})}})},handleUpdate:function(t){this.formData=i.i(n.e)(t),this.dialogStatus="update",this.dialogFormVisible=!0},update:function(t){var e=this;this.loading=!0,this.updateProduct(this.formData).then(function(){e.dialogFormVisible=!1,e.loading=!1,t||i.i(n.d)(),e.query()}).catch(function(o){t||i.i(n.d)("",{type:"error"}),e.loading=!1})},openHandleDelete:function(t){var e=this;if(this.queryAllDetails({projection:"cable"}).then(function(){e.loading=!1}).catch(function(t){console.log(t),e.loading=!1}),this.productDetails.filter(function(e){return e.productName===t.productName}).length>0)return void this.$alert("该产品中包含产品详情，请先删除该产品下的产品详情。","提示",{confirmButtonText:"确定"});this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){e.deleteProduct(t).then(function(){i.i(n.d)(),e.query()}).catch(function(o){if(o&&o.response&&o.response.status){if(409===o.response.status){var a=r()({},i.i(n.e)(t),{bigProduct:"bigProducts/"+t.bigProduct.id});e.formData=a,e.update(!0)}}i.i(n.d)("",{type:"error"})})}).catch(function(){i.i(n.d)("已取消删除",{type:"info"})})}})}},XitI:function(t,e,i){"use strict";function o(t){i("JIR/")}Object.defineProperty(e,"__esModule",{value:!0});var r=i("MhFO"),a=i("oQv2"),n=i("VU/8"),l=o,c=n(r.a,a.a,l,null,null);e.default=c.exports},oQv2:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("el-input",{attrs:{placeholder:"产品名称"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.query(e)}},model:{value:t.searchForm.productName,callback:function(e){t.$set(t.searchForm,"productName",e)},expression:"searchForm.productName"}})],1),t._v(" "),i("el-col",{attrs:{span:10}},[i("el-button",{attrs:{loading:t.loading,icon:"el-icon-search"},on:{click:t.query}},[t._v("搜索")]),t._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v("添加")])],1)],1),t._v(" "),i("el-table",{attrs:{data:t.bigProduct.children,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"序号",width:"380",type:"index"}}),t._v(" "),i("el-table-column",{attrs:{label:"产品名称","min-width":"400",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.productName)+"\n      ")]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"380"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){t.handleUpdate(e.row)}}},[i("i",{staticClass:"el-icon-edit"})]),t._v(" "),i("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(i){t.openHandleDelete(e.row)}}},[i("i",{staticClass:"el-icon-delete"})])]}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"productForm",staticClass:"small-space",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:t.formData,"label-position":"right","label-width":"120px"}},[i("el-form-item",{attrs:{label:"产品名称",prop:"productName",rules:[{required:!0,message:"产品名称不能为空"}]}},[i("el-input",{model:{value:t.formData.productName,callback:function(e){t.$set(t.formData,"productName",e)},expression:"formData.productName"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?i("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.create}},[t._v("确定")]):i("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.update}},[t._v("确定")])],1)],1)],1)},r=[],a={render:o,staticRenderFns:r};e.a=a}});