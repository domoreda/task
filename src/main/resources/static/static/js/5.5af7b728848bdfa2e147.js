webpackJsonp([5],{AMNR:function(t,e,o){"use strict";function a(t){o("Ihyg")}Object.defineProperty(e,"__esModule",{value:!0});var i=o("X7jA"),l=o("Fjvk"),r=o("VU/8"),n=a,s=r(i.a,l.a,n,null,null);e.default=s.exports},E3NE:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".el-tooltip__popper{max-width:40vw!important}",""])},Fjvk:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[o("el-col",{attrs:{span:6}},[o("el-input",{attrs:{placeholder:"标题"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.query(e)}},model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1),t._v(" "),o("el-col",{attrs:{span:10}},[o("el-button",{attrs:{loading:t.loading,icon:"el-icon-search"},on:{click:t.query}},[t._v("搜索")]),t._v(" "),o("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v("添加")])],1)],1),t._v(" "),o("el-table",{attrs:{data:t.details,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""}},[o("el-table-column",{attrs:{align:"center",label:"序号",width:"90",type:"index"}}),t._v(" "),o("el-table-column",{attrs:{label:"标题","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.title)+"\n      ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"核心词","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.coreWord)+"\n      ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"缩略图","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.thumbnail?o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){t.previewPhotoAttachment(e.row.thumbnail,"thumbnail")}}},[t._v("查看照片")]):o("span",[t._v("暂无照片")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"图册","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.photo?o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){t.previewPhotoAttachment(e.row.photo,"photo")}}},[t._v("查看照片")]):o("span",[t._v("暂无照片")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"属性","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.property)+"\n      ")]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"发布时间","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.releaseDate)+"\n      ")]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"center",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){t.handleUpdate(e.row)}}},[o("i",{staticClass:"el-icon-edit"})]),t._v(" "),o("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(o){t.openHandleDelete(e.row)}}},[o("i",{staticClass:"el-icon-delete"})])]}}])})],1),t._v(" "),o("el-dialog",{attrs:{title:"照片预览",visible:t.photoDialogVisible},on:{"update:visible":function(e){t.photoDialogVisible=e},close:t.previewPhotoAttachmentClose}},[0===!t.selectedPhotoAttachmentOptions.length?o("p",[t._v("没有上传照片附件")]):t._l(t.selectedPhotoAttachmentOptions,function(t){return o("img",{key:t.photoAttachment,staticStyle:{width:"100%"},attrs:{src:t.photoAttachment}})})],2),t._v(" "),o("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"detailForm",staticClass:"small-space",staticStyle:{"margin-left":"30px","margin-right":"50px"},attrs:{model:t.formData,"label-position":"right","label-width":"120px"}},[o("el-form-item",{attrs:{label:"标题",prop:"title",rules:[{required:!0,message:"标题不能为空"}]}},[o("el-input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"产品价格",prop:"price",rules:[{required:!0,message:"价格不能为空"}]}},[o("el-input",{model:{value:t.formData.price,callback:function(e){t.$set(t.formData,"price",e)},expression:"formData.price"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"缩略图",prop:"thumbnail"}},[o("el-upload",{attrs:{action:"/api/resource/upload","on-remove":t.handleThumbnailFileRemove,"on-success":t.handleThumbnailUploadFileSuccess,limit:1,"on-exceed":t.handleExceed,"file-list":t.thumbnailFileList}},[o("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-upload"}},[t._v("上传照片")])],1)],1),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"图片相册"}},[o("el-upload",{attrs:{action:"/api/resource/upload","on-remove":t.handlePhotoFileRemove,"on-success":t.handlePhotoUploadFileSuccess,limit:4,"on-exceed":t.handleExceed,"file-list":t.photoFileList}},[o("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-upload"}},[t._v("上传照片")])],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"核心词",prop:"coreWord",rules:[{required:!0,message:"核心词不能为空"}]}},[o("el-input",{model:{value:t.formData.coreWord,callback:function(e){t.$set(t.formData,"coreWord",e)},expression:"formData.coreWord"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"属性",prop:"property"}},[o("el-select",{attrs:{filterable:""},model:{value:t.formData.property,callback:function(e){t.$set(t.formData,"property",e)},expression:"formData.property"}},t._l(t.propertyOptions,function(e){return o("el-option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.value))])}))],1),t._v(" "),o("el-form-item",{attrs:{label:"发布日期",prop:"releaseDate",rules:[{required:!0,message:"发布日期不能为空"}]}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",editable:""},model:{value:t.formData.releaseDate,callback:function(e){t.$set(t.formData,"releaseDate",e)},expression:"formData.releaseDate"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"内容摘要",prop:"contentAbstract",rules:[{required:!0,message:"内容摘要不能为空"}]}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:t.formData.contentAbstract,callback:function(e){t.$set(t.formData,"contentAbstract",e)},expression:"formData.contentAbstract"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"内容描述",prop:"description",rules:[{required:!0,message:"内容描述不能为空"}]}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:20,maxRows:100},placeholder:"请输入内容"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?o("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.create}},[t._v("确定")]):o("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.update}},[t._v("确定")])],1)],1)],1)},i=[],l={render:a,staticRenderFns:i};e.a=l},Ihyg:function(t,e,o){var a=o("E3NE");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("8aebba56",a,!0)},X7jA:function(t,e,o){"use strict";var a=o("Dd8w"),i=o.n(a),l=o("NYxO"),r=o("0xDb"),n={id:0,title:"",price:"",thumbnail:"",property:"",photo:"",coreWord:"",contentAbstract:"",description:"",releaseDate:""},s={page:0,size:999,projection:"cable",title:""},c=[{value:"无",label:"无"},{value:"热门",label:"热门"},{value:"推荐",label:"推荐"}];e.a={data:function(){return{loading:!1,dialogFormVisible:!1,dialogStatus:"",searchForm:o.i(r.e)(s),textMap:{update:"编辑",create:"创建"},formData:o.i(r.e)(n),details:[],photoDialogVisible:!1,selectedPhotoAttachmentOptions:[],photoFileList:[],thumbnailFileList:[],propertyOptions:c}},computed:i()({},o.i(l.b)(["productDetails","selectedProduct","products"])),mounted:function(){if(!this.selectedProduct.id)return void this.$alert("未选择产品，无法进行操作。请先在左侧菜单中选择产品","提示",{confirmButtonText:"确定"});this.query()},watch:{productDetails:function(){var t=this,e=this.productDetails.filter(function(e){return e.productName===t.selectedProduct.productName});e.length&&(this.details=e[0].children)}},methods:i()({},o.i(l.c)(["createProductDetail","updateProductDetail","deleteProductDetail","queryAllDetails"]),{query:function(){var t=this;this.loading=!0,this.queryAllDetails(this.searchForm).then(function(){t.loading=!1}).catch(function(e){console.log(e),t.loading=!1})},handleCreate:function(){if(this.thumbnailFileList=[],this.photoFileList=[],!this.selectedProduct.id)return void this.$alert("未选择产品，无法进行操作。请先在左侧菜单中选择产品","提示",{confirmButtonText:"确定"});this.formData=o.i(r.e)(n),this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(t){if(this.thumbnailFileList=[],this.photoFileList=[],!this.selectedProduct.id)return void this.$alert("未选择产品，无法进行操作。请先在左侧菜单中选择产品","提示",{confirmButtonText:"确定"});this.formData=o.i(r.e)(t),this.dialogStatus="update",this.dialogFormVisible=!0;var e=this.formData,a=e.thumbnail,i=e.photo;this.previewPhotoAttachment(a,"thumbnail",!0),this.previewPhotoAttachment(i,"photo",!0)},openHandleDelete:function(t){var e=this;if(!this.selectedProduct.id)return void this.$alert("未选择产品，无法进行操作。请先在左侧菜单中选择产品","提示",{confirmButtonText:"确定"});this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){e.deleteProductDetail(t).then(function(){o.i(r.d)(),e.query()}).catch(function(t){o.i(r.d)("",{type:"error"})})}).catch(function(){o.i(r.d)("已取消删除",{type:"info"})})},create:function(){var t=this;this.$refs.detailForm.validate(function(e){if(e){t.loading=!0;var a={pid:t.selectedProduct.id,detail:t.formData,product:t.products};t.createProductDetail(a).then(function(){o.i(r.d)(),t.dialogFormVisible=!1,t.loading=!1,t.query()}).catch(function(e){o.i(r.d)("",{type:"error"}),t.loading=!1})}})},update:function(t){var e=this;this.loading=!0,this.updateProductDetail(this.formData).then(function(){e.dialogFormVisible=!1,e.loading=!1,t||o.i(r.d)(),e.query()}).catch(function(a){t||o.i(r.d)("",{type:"error"}),e.loading=!1})},handleThumbnailFileRemove:function(t){var e=this.formData.thumbnail,o=e.replace(t.name+",","");if(o!==e)this.formData.thumbnail=o;else{var a=e.replace(t.name,"");this.formData.thumbnail=a}},handlePhotoFileRemove:function(t){var e=this.formData.photo,o=e.replace(t.name+",","");if(o!==e)this.formData.photo=o;else{var a=e.replace(t.name,"");this.formData.photo=a}},handleThumbnailUploadFileSuccess:function(t,e,o){this.formData.thumbnail=t[0]},handlePhotoUploadFileSuccess:function(t,e,o){t&&t.length&&(this.formData.photo?this.formData.photo+=",":this.formData.photo="",this.formData.photo+=t[0])},handleExceed:function(t,e){o.i(r.d)("缩略图最多可上传1张照片，图册最多4张",{type:"warning"})},previewPhotoAttachment:function(t,e,o){if(o||(this.photoDialogVisible=!0),t){this.selectedPhotoAttachmentOptions=[];var a=[],i=t.indexOf(":")>-1,l=t.split(",");if(!i)for(var r=0;r<l.length;r++)if(l[r]){var n="/api/resource/download/"+l[r],s={name:l[r],photoAttachment:n};this.selectedPhotoAttachmentOptions.push(s),a.push(s)}"photo"===e&&(this.photoFileList=a),"thumbnail"===e&&(this.thumbnailFileList=a)}},previewPhotoAttachmentClose:function(){this.selectedPhotoAttachmentOptions=[]}})}}});