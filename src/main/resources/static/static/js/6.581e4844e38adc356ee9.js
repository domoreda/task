webpackJsonp([6],{MT4w:function(t,e,a){"use strict";function o(t){a("pN0C")}Object.defineProperty(e,"__esModule",{value:!0});var i=a("Y3CR"),n=a("Pmi3"),l=a("VU/8"),r=o,s=l(i.a,n.a,r,"data-v-e3c1ba6c",null);e.default=s.exports},Pmi3:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:24}},[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{placeholder:"案例名"},model:{value:t.searchForm.caseName,callback:function(e){t.$set(t.searchForm,"caseName",e)},expression:"searchForm.caseName"}})],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{loading:t.loading,icon:"el-icon-search"},on:{click:t.query}},[t._v("搜索")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v("添加")])],1)],1),t._v(" "),a("el-table",{attrs:{data:t.productCase,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"序号",width:"80",type:"index"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100",align:"center",label:"案例名"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.caseName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"照片","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.photo?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.previewPhotoAttachment(e.row.photo)}}},[t._v("查看照片")]):a("span",[t._v("暂无照片")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",align:"center",label:"发布日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.date))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","min-width":"80",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.handleUpdate(e.row)}}},[a("i",{staticClass:"el-icon-edit"})]),t._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(a){t.openHandleDelete(e.row)}}},[a("i",{staticClass:"el-icon-delete"})])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"照片预览",visible:t.photoDialogVisible},on:{"update:visible":function(e){t.photoDialogVisible=e},close:t.previewPhotoAttachmentClose}},[0===!t.selectedPhotoAttachmentOptions.length?a("p",[t._v("没有上传照片附件")]):t._l(t.selectedPhotoAttachmentOptions,function(t){return a("img",{key:t.photoAttachment,staticStyle:{width:"100%"},attrs:{src:t.photoAttachment}})})],2),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"productCaseForm",staticClass:"small-space",staticStyle:{width:"700px","margin-left":"50px","margin-right":"50px"},attrs:{model:t.formData,"label-position":"right","label-width":"120px"}},[a("el-form-item",{attrs:{label:"案例名",prop:"caseName",rules:[{required:!0,message:"案例名不能为空"}]}},[a("el-input",{model:{value:t.formData.caseName,callback:function(e){t.$set(t.formData,"caseName",e)},expression:"formData.caseName"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"产品照片"}},[a("el-upload",{attrs:{action:"/api/resource/upload","on-remove":t.handlePhotoFileRemove,"on-success":t.handlePhotoUploadFileSuccess,limit:1,"on-exceed":t.handleExceed,"file-list":t.photoFileList}},[a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-upload"}},[t._v("上传照片")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"发布日期",prop:"date",rules:[{required:!0,message:"发布日期不能为空"}]}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",editable:""},model:{value:t.formData.date,callback:function(e){t.$set(t.formData,"date",e)},expression:"formData.date"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"内容描述",prop:"description",rules:[{required:!0,message:"内容描述不能为空"}]}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:20,maxRows:100},placeholder:"请输入内容"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.create}},[t._v("确定")]):a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.update}},[t._v("确定")])],1)],1)],1)},i=[],n={render:o,staticRenderFns:i};e.a=n},Q8F5:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"",""])},Y3CR:function(t,e,a){"use strict";var o=a("Dd8w"),i=a.n(o),n=a("NYxO"),l=a("0xDb"),r={id:0,caseName:"",photo:"",description:"",date:""},s={page:0,size:20,caseName:""};e.a={data:function(){return{loading:!1,dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建"},formData:a.i(l.c)(r),searchForm:a.i(l.c)(s),photoDialogVisible:!1,selectedPhotoAttachmentOptions:[],photoFileList:[]}},computed:i()({},a.i(n.b)(["productCase"])),mounted:function(){this.query()},methods:i()({},a.i(n.c)(["queryProductCase","createProductCase","updateProductCase","deleteProductCase"]),{query:function(){var t=this;this.loading=!0,this.queryProductCase(this.searchForm).then(function(){t.loading=!1}).catch(function(e){console.log(e),t.loading=!1})},handleCreate:function(){this.formData=a.i(l.c)(r),this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(t){this.formData=a.i(l.c)(t),this.dialogStatus="update",this.dialogFormVisible=!0;var e=this.formData.photo;this.previewPhotoAttachment(e,"photo")},openHandleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteProductCase(t).then(function(){a.i(l.d)(),e.query()}).catch(function(t){a.i(l.d)("",{type:"error"})})}).catch(function(){a.i(l.d)("已取消删除",{type:"info"})})},create:function(){var t=this;this.$refs.productCaseForm.validate(function(e){e&&(t.loading=!0,t.createProductCase(t.formData).then(function(){a.i(l.d)(),t.query(),t.dialogFormVisible=!1}).catch(function(t){a.i(l.d)("",{type:"error"})}).then(function(){t.loading=!1}))})},update:function(){var t=this;this.$refs.productCaseForm.validate(function(e){e&&(t.loading=!0,t.updateProductCase(t.formData).then(function(){a.i(l.d)(),t.query(),t.dialogFormVisible=!1}).catch(function(t){a.i(l.d)("",{type:"error"})}).then(function(){t.loading=!1}))})},handlePhotoFileRemove:function(t){var e=this.formData.photo,a=e.replace(t.name+",","");if(a!==e)this.formData.photo=a;else{var o=e.replace(t.name,"");this.formData.photo=o}},handlePhotoUploadFileSuccess:function(t,e,a){t&&t.length&&(this.formData.photo?this.formData.photo+=",":this.formData.photo="",this.formData.photo+=t[0])},handleExceed:function(t,e){a.i(l.d)("最多可长传1张图片",{type:"warning"})},previewPhotoAttachment:function(t,e){if(e||(this.photoDialogVisible=!0),t){this.selectedPhotoAttachmentOptions=[],this.fileList=[];var a=t.indexOf(":")>-1,o=t.split(",");if(!a)for(var i=0;i<o.length;i++)if(o[i]){var n="/api/resource/download/"+o[i],l={name:o[i],photoAttachment:n};this.selectedPhotoAttachmentOptions.push(l),this.fileList.push(l)}}},previewPhotoAttachmentClose:function(){this.selectedPhotoAttachmentOptions=[]}})}},pN0C:function(t,e,a){var o=a("Q8F5");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("4938e205",o,!0)}});